{
    "openapi": "3.0.0",
    "info": {
        "title": "Zia Carbon Footprint API",
        "description": "API documentation for the Zia Carbon Footprint Dashboard and Backend logic.",
        "contact": {
            "email": "support@zia.com"
        },
        "version": "1.0.0"
    },
    "servers": [
        {
            "url": "http://my-default-host.com",
            "description": "Dynamic Host"
        }
    ],
    "paths": {
        "/api/admin/companies": {
            "get": {
                "tags": [
                    "Admin - Companies"
                ],
                "summary": "List all companies with periods (Admin)",
                "operationId": "aa7f49a5bd3c35517ffdaa353feb612f",
                "responses": {
                    "200": {
                        "description": "List of companies"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            },
            "post": {
                "tags": [
                    "Admin - Companies"
                ],
                "summary": "Create a new company",
                "operationId": "f1c7e1b7eac446bd837cfa44833139a5",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "name",
                                    "nit"
                                ],
                                "properties": {
                                    "name": {
                                        "type": "string",
                                        "example": "Acme Corp"
                                    },
                                    "nit": {
                                        "type": "string",
                                        "example": "123456789-0"
                                    },
                                    "sector_id": {
                                        "type": "integer",
                                        "example": 1
                                    },
                                    "logo_url": {
                                        "type": "string",
                                        "example": "https://example.com/logo.png"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Created"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/admin/companies/{company}": {
            "put": {
                "tags": [
                    "Admin - Companies"
                ],
                "summary": "Update a company",
                "operationId": "e8afe8dcf21bf1c0cc08846aae1ef28b",
                "parameters": [
                    {
                        "name": "company",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Updated"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            },
            "delete": {
                "tags": [
                    "Admin - Companies"
                ],
                "summary": "Soft delete a company",
                "operationId": "6ddd8e0a4568489ad8faf1b640e5bbae",
                "parameters": [
                    {
                        "name": "company",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "204": {
                        "description": "Deleted"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/admin/companies/{company}/periods": {
            "post": {
                "tags": [
                    "Admin - Companies"
                ],
                "summary": "Add a new period to a company",
                "operationId": "d07bb96c70a64839dd389f2ac5f4dc5b",
                "parameters": [
                    {
                        "name": "company",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "year",
                                    "status"
                                ],
                                "properties": {
                                    "year": {
                                        "type": "integer",
                                        "example": 2024
                                    },
                                    "status": {
                                        "type": "string",
                                        "example": "open"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Period added"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/admin/periods/{period}": {
            "put": {
                "tags": [
                    "Admin - Companies"
                ],
                "summary": "Update a period",
                "operationId": "b13505062ae7d9fe6fb1b63702e37093",
                "parameters": [
                    {
                        "name": "period",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Updated"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            },
            "delete": {
                "tags": [
                    "Admin - Companies"
                ],
                "summary": "Delete a period",
                "operationId": "7cce2efa3c2f9b7a083906e2142e56f1",
                "parameters": [
                    {
                        "name": "period",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "204": {
                        "description": "Deleted"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/admin/sectors": {
            "get": {
                "tags": [
                    "Admin - Sectors"
                ],
                "summary": "List all company sectors",
                "operationId": "c03e57c3fd398f2691b8036d15c00867",
                "responses": {
                    "200": {
                        "description": "List of sectors",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "type": "object"
                                    }
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            },
            "post": {
                "tags": [
                    "Admin - Sectors"
                ],
                "summary": "Create a new company sector",
                "operationId": "c95c19c85d651801332d50e636df4bbe",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "name"
                                ],
                                "properties": {
                                    "name": {
                                        "type": "string",
                                        "example": "Industrial"
                                    },
                                    "description": {
                                        "type": "string",
                                        "example": "Industrial and manufacturing sector"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Created"
                    },
                    "422": {
                        "description": "Validation error"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/admin/sectors/{sector}": {
            "get": {
                "tags": [
                    "Admin - Sectors"
                ],
                "summary": "Get sector details",
                "operationId": "f35e5b0e723177e11764364882e1456f",
                "parameters": [
                    {
                        "name": "sector",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Sector details"
                    },
                    "404": {
                        "description": "Not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            },
            "put": {
                "tags": [
                    "Admin - Sectors"
                ],
                "summary": "Update a company sector",
                "operationId": "7819322d5054c4e1cc82639b55453827",
                "parameters": [
                    {
                        "name": "sector",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "name": {
                                        "type": "string",
                                        "example": "Industrial Updated"
                                    },
                                    "description": {
                                        "type": "string",
                                        "example": "Updated description"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Updated"
                    },
                    "404": {
                        "description": "Not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            },
            "delete": {
                "tags": [
                    "Admin - Sectors"
                ],
                "summary": "Delete a company sector",
                "operationId": "840b5b3ef746c3af47a2b965c2ed5c07",
                "parameters": [
                    {
                        "name": "sector",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "204": {
                        "description": "Deleted"
                    },
                    "404": {
                        "description": "Not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/periods/{period}/emissions": {
            "get": {
                "tags": [
                    "Emissions"
                ],
                "summary": "List all emissions for a specific period",
                "operationId": "650b1174696d77a7e85a6f8ba9531462",
                "parameters": [
                    {
                        "name": "period",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of emissions",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "type": "object"
                                    }
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            },
            "post": {
                "tags": [
                    "Emissions"
                ],
                "summary": "Calculate and store a new carbon emission record",
                "operationId": "b686da77f5edd8b74baacdf606956fb0",
                "parameters": [
                    {
                        "name": "period",
                        "in": "path",
                        "description": "The ID of the period",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "emission_factor_id"
                                ],
                                "properties": {
                                    "emission_factor_id": {
                                        "type": "integer",
                                        "example": 1
                                    },
                                    "quantity": {
                                        "description": "Total activity data if monthly_inputs not provided",
                                        "type": "number",
                                        "format": "float",
                                        "example": 100
                                    },
                                    "monthly_inputs": {
                                        "description": "Array of monthly values for uncertainty analysis",
                                        "type": "array",
                                        "items": {
                                            "type": "number",
                                            "format": "float"
                                        },
                                        "example": [
                                            10,
                                            20,
                                            30
                                        ]
                                    },
                                    "notes": {
                                        "type": "string",
                                        "example": "Monthly fuel consumption"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Emission record created and calculated successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "id": {
                                            "type": "integer",
                                            "example": 1
                                        },
                                        "calculated_co2e": {
                                            "type": "number",
                                            "format": "float",
                                            "example": 5.67
                                        },
                                        "uncertainty_result": {
                                            "type": "number",
                                            "format": "float",
                                            "example": 0.25
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthenticated"
                    },
                    "422": {
                        "description": "Validation error"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/emissions/{emission}": {
            "delete": {
                "tags": [
                    "Emissions"
                ],
                "summary": "Delete an emission record",
                "operationId": "88f8bf4106bce038f1744da40cfc3b23",
                "parameters": [
                    {
                        "name": "emission",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "204": {
                        "description": "Deleted successfully"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/companies": {
            "get": {
                "tags": [
                    "Companies"
                ],
                "summary": "List all companies",
                "operationId": "a261a49d113a2af2a5ccb5798c6aae7e",
                "responses": {
                    "200": {
                        "description": "List of companies",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "type": "object"
                                    }
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/companies/{company}/periods": {
            "get": {
                "tags": [
                    "Companies"
                ],
                "summary": "Get periods for a specific company",
                "operationId": "629b1e3b8bfbdad0f5eee9d6914d59e6",
                "parameters": [
                    {
                        "name": "company",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of periods",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "type": "object"
                                    }
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/dictionaries/factors": {
            "get": {
                "tags": [
                    "Master Data"
                ],
                "summary": "Get all emission factors grouped by category",
                "description": "Use this to populate dropdowns in the frontend. Includes nested factors for each category.",
                "operationId": "1066c5ec0b7121723b7d5d5fdf9b7d86",
                "responses": {
                    "200": {
                        "description": "Grouped categories and factors",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "type": "object"
                                    }
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/register": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Register a new user",
                "operationId": "8a56853624e025573120a09a4c75d468",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "name",
                                    "email",
                                    "password"
                                ],
                                "properties": {
                                    "name": {
                                        "type": "string",
                                        "example": "John Doe"
                                    },
                                    "email": {
                                        "type": "string",
                                        "format": "email",
                                        "example": "john@example.com"
                                    },
                                    "password": {
                                        "type": "string",
                                        "format": "password",
                                        "example": "password123"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "User registered successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "user": {
                                            "type": "object"
                                        },
                                        "token": {
                                            "type": "string"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation error"
                    }
                }
            }
        },
        "/api/login": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Login to get access token",
                "operationId": "a3b306d14572d1f4bd6c064b3233e7b8",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "email",
                                    "password"
                                ],
                                "properties": {
                                    "email": {
                                        "type": "string",
                                        "format": "email",
                                        "example": "admin@zia.com"
                                    },
                                    "password": {
                                        "type": "string",
                                        "format": "password",
                                        "example": "password"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successful login",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "user": {
                                            "type": "object"
                                        },
                                        "token": {
                                            "type": "string"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Invalid credentials"
                    }
                }
            }
        },
        "/api/logout": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Logout the current user",
                "operationId": "fe8f3429cd6979b3b4517e186505f9f9",
                "responses": {
                    "200": {
                        "description": "Successfully logged out"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/user": {
            "get": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Get the authenticated user",
                "operationId": "7c1cf647d76fad4b3eb1549fa4fe2f4c",
                "responses": {
                    "200": {
                        "description": "Current user details"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        }
    },
    "components": {
        "securitySchemes": {
            "bearerAuth": {
                "type": "http",
                "bearerFormat": "JWT",
                "scheme": "bearer"
            }
        }
    },
    "tags": [
        {
            "name": "Admin - Companies",
            "description": "Admin - Companies"
        },
        {
            "name": "Admin - Sectors",
            "description": "Admin - Sectors"
        },
        {
            "name": "Emissions",
            "description": "Emissions"
        },
        {
            "name": "Companies",
            "description": "Companies"
        },
        {
            "name": "Master Data",
            "description": "Master Data"
        },
        {
            "name": "Authentication",
            "description": "Authentication"
        }
    ]
}